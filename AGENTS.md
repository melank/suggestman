# Suggestman チーム体制

Suggestman の開発と運用を支える仮想エージェントの役割と連携サイクルをまとめます。

## 役割一覧

### プロダクトキュレーター
**ミッション**: プロダクトビジョンの実現とユーザー価値の最大化

**主な責任**:
- ユースケースの整理とアイデアの優先順位付け
- ロードマップ管理と機能要件の定義
- 「メモ帳との差分」という価値仮説の検証と改善
- ステークホルダーとのコミュニケーション

**開発フェーズでの重要度**:
- MVP: ★★★★★ (コアバリューの定義が最重要)
- 成長期: ★★★★☆ (機能の取捨選択)
- 成熟期: ★★★☆☆ (最適化フェーズ)

### UX クラフター
**ミッション**: 直感的で心地よいユーザー体験の創出

**主な責任**:
- 画面フロー、インタラクション、トーン＆マナーのデザイン
- トリガー操作の最短化と提案カードの感情設計
- ユーザーテストの設計と実施
- アクセシビリティの確保

**開発フェーズでの重要度**:
- MVP: ★★★★☆ (シンプルさが重要)
- 成長期: ★★★★★ (差別化要因)
- 成熟期: ★★★★☆ (継続的改善)

### システムアーキテクト
**ミッション**: スケーラブルで保守性の高い技術基盤の構築

**主な責任**:
- ドメインモデルとデータスキーマの設計
- API 設計とストレージ選定
- パフォーマンス要件の定義
- 将来の拡張性（自動提案、パーソナライズ）を見据えた設計

**開発フェーズでの重要度**:
- MVP: ★★★★★ (土台作りが最重要)
- 成長期: ★★★★☆ (スケーリング対応)
- 成熟期: ★★★☆☆ (リファクタリング)

### エクスペリエンスエンジニア
**ミッション**: 高品質な実装と安定したサービス提供

**主な責任**:
- Hono + Cloudflare Workers による API 実装
- 提案ロジックの実装と品質維持
- テストコードの作成と CI/CD パイプラインの整備
- パフォーマンス計測と最適化

**開発フェーズでの重要度**:
- MVP: ★★★★★ (実装が最優先)
- 成長期: ★★★★★ (機能追加と品質維持)
- 成熟期: ★★★★☆ (技術的負債の解消)

### インサイトアナリスト
**ミッション**: データドリブンな意思決定の支援

**主な責任**:
- 提案結果のログ解析と可視化
- 受容/スキップ傾向の分析
- ユーザー行動パターンの発見
- プロダクトキュレーターへの改善提案

**開発フェーズでの重要度**:
- MVP: ★★☆☆☆ (基本的なログ収集のみ)
- 成長期: ★★★★☆ (データ活用開始)
- 成熟期: ★★★★★ (最適化の鍵)

### QA スチュワード
**ミッション**: 品質保証とリリース後のユーザー体験保護

**主な責任**:
- テストシナリオの設計（手動・自動）
- 回帰テストの実施
- 新機能追加時の品質チェック
- リリース判定基準の策定

**開発フェーズでの重要度**:
- MVP: ★★★☆☆ (最低限の動作確認)
- 成長期: ★★★★☆ (品質基準の確立)
- 成熟期: ★★★★★ (安定性の維持)

## コラボレーションリズム

### 定例ミーティング
- **毎週: プロダクト & UX シンク** (60分)
  - 参加: プロダクトキュレーター、UX クラフター、エクスペリエンスエンジニア
  - 内容: フィードバック共有、次リリース候補の合意形成、ユーザーストーリーの精緻化

- **隔週: テックハドル** (90分)
  - 参加: システムアーキテクト、エクスペリエンスエンジニア、QA スチュワード
  - 内容: バックログ精査、技術的意思決定、スコープ調整、技術的負債の評価

- **リリースごと: ポストリリースレトロ** (60分)
  - 参加: 全員
  - 内容: 提案行動の変化とログ分析結果の振り返り、KPI レビュー、改善アクションの策定

### 非同期コミュニケーション
- **デイリーアップデート**: 各自の進捗と課題を共有
- **意思決定ログ**: 重要な決定事項をドキュメント化
- **質問チャネル**: 疑問点の迅速な解決

## 役割間の連携フロー

### 機能開発の典型的な流れ
1. **プロダクトキュレーター** → ユーザー要望を整理し、機能要件を定義
2. **UX クラフター** → ユーザーフローとインタラクションを設計
3. **システムアーキテクト** → データモデルと API 仕様を策定
4. **エクスペリエンスエンジニア** → 実装とテストコード作成
5. **QA スチュワード** → 統合テストと品質確認
6. **インサイトアナリスト** → リリース後の効果測定

### 問題発生時のエスカレーション
- 技術的ブロッカー: エンジニア → アーキテクト → プロダクトキュレーター
- UX 上の懸念: 誰でも → UX クラフター → プロダクトキュレーター
- 品質リスク: QA → エンジニア → プロダクトキュレーター

## 意思決定プロセス

### 意思決定の優先順位
1. **ユーザー価値**: 最終的な価値提供を最優先
2. **技術的実現性**: 期限内に実現可能か
3. **保守性**: 長期的な運用コスト
4. **スコープ**: MVP の範囲に収まるか

### 決定が必要な主なトピック
- 機能の追加/削除: プロダクトキュレーター主導、全員で議論
- 技術選定: システムアーキテクト主導、エンジニアと合意
- UX 変更: UX クラフター主導、プロダクトと合意
- リリース判定: QA スチュワード + エクスペリエンスエンジニア

## タスクと役割のマッピング例

### MVP フェーズでの具体的なタスク

**提案エンドポイント実装** (`POST /api/suggestions`)
- プロダクトキュレーター: 要件定義、受容基準の設定
- システムアーキテクト: API 仕様、データフロー設計
- エクスペリエンスエンジニア: 実装、ユニットテスト
- QA スチュワード: 統合テストシナリオ作成

**クールダウン機能の実装**
- プロダクトキュレーター: クールダウン期間の仕様決定
- UX クラフター: ユーザーへのフィードバック方法の設計
- システムアーキテクト: ストレージ設計（履歴テーブル）
- エクスペリエンスエンジニア: ロジック実装
- インサイトアナリスト: 効果測定方法の設計

**タグベースのフィルタリング**
- プロダクトキュレーター: タグの種類と優先順位の決定
- UX クラフター: タグ選択 UI の設計
- システムアーキテクト: データモデル（tags テーブル、関連テーブル）
- エクスペリエンスエンジニア: フィルタリングロジック実装
- QA スチュワード: エッジケースのテスト

## ツール運用メモ

### 開発ツール
- **IDE**: VSCode + Biome 拡張機能推奨
- **バージョン管理**: Git + GitHub
- **Git フック管理**: Husky（コミット前の自動フォーマット・リントチェック）
- **CI/CD**: GitHub Actions (Lint、TypeCheck、デプロイ)
- **デバッグ**: Wrangler Dev + Chrome DevTools

#### Husky による自動チェック

このプロジェクトでは、[Husky](https://typicode.github.io/husky/) を使用して Git コミット前に自動的にコードフォーマットとリントチェックを実行します。

**動作:**
- `git commit` 実行時に自動的に以下が実行されます:
  1. `npm run format` - Biome によるコードの自動フォーマット
  2. `npm run lint` - Biome によるリントチェック
- リントエラーがある場合はコミットが中止されます

**設定ファイル:**
- `.husky/pre-commit`: pre-commit フックのスクリプト
- `package.json`: `prepare` スクリプトで Husky を自動初期化

**利点:**
- コミット前に自動的にコード品質をチェック
- チーム全体でコードスタイルの一貫性を保つ
- CI/CD でのエラーを事前に防ぐ

### コラボレーションツール
- **デザイン**: Figma などの共同編集環境で画面遷移図とコンポーネント管理
- **課題管理**: GitHub Issues でロードマップとタスクを一元化
- **ドキュメント**: Markdown ファイルを Git 管理（README.md、Claude.md、AGENTS.md など）
- **分析**: Cloudflare Logs や外部 BI ツールへ出力し、インサイトアナリストがダッシュボード化

### ドキュメント管理
- **技術仕様**: README.md（システム構成、API 設計）
- **開発ガイド**: Claude.md（Claude Code 向けガイドライン）
- **チーム体制**: AGENTS.md（本ドキュメント）
- **決定事項**: ADR (Architecture Decision Records) 形式で記録

## 現在の開発ステータス (MVP)

### 完了済み
- ✅ Hono プロジェクトの初期セットアップ
- ✅ Cloudflare D1 の初期設定
- ✅ 基本的なルーティング構造

### 進行中
- 🚧 `POST /api/suggestions` の実装
- 🚧 ストレージアクセスレイヤの整備

### 未着手
- ⏳ 提案アルゴリズム MVP 版（クールダウン機能含む）
- ⏳ ロギング/監視の初期設計
- ⏳ テストスイートの構築

## 参考: チームとしての行動指針

1. **ユーザーファースト**: 技術的な美しさよりもユーザー価値を優先
2. **小さく始める**: MVP で検証してから機能を拡張
3. **透明性**: 意思決定プロセスと理由をドキュメント化
4. **継続的改善**: レトロスペクティブで学びを共有
5. **オーナーシップ**: 各自の専門領域に責任を持つが、他者の領域も尊重

## AI エージェント操作ルール

### コマンド実行について
- ❌ **run_terminal_cmd ツールを使用しない**: ユーザーがすべてのコマンドを手動で実行します
- ✅ **実行すべきコマンドを説明する**: 必要なコマンドとその目的を日本語で明確に説明してください
- ✅ **コマンドはコードブロックで提示する**: ユーザーがコピー&ペーストしやすいように記載してください

### JavaScript ファイルの分離ルール

**重要**: Hono JSX では、HTML ビュー内に JavaScript を直接記述できません。

#### 制約事項
- Hono JSX の `<script>` タグ内では、`{}` が JSX 式として解釈されるため JavaScript が正しく動作しない
- インライン JavaScript は CSP (Content Security Policy) 違反のリスクがある
- `dangerouslySetInnerHTML` の使用は避けるべき（セキュリティリスク）

#### 実装パターン
1. **JavaScript は `src/routes/static.ts` で配信**:
   ```typescript
   app.get("/your-page.js", (c) => {
     const js = `function yourFunction() { /* ... */ }`;
     return c.text(js, 200, {
       "Content-Type": "application/javascript",
       "Cache-Control": "public, max-age=3600",
     });
   });
   ```

2. **HTML ビューでは外部ファイルを参照**:
   ```tsx
   <script src="/static/your-page.js"></script>
   ```

3. **利点**:
   - セキュリティ: XSS 攻撃のリスク軽減
   - パフォーマンス: ブラウザキャッシュが効く
   - 保守性: コードの分離とデバッグのしやすさ

詳細は `CLAUDE.md` の「JavaScript の外部ファイル分離パターン」を参照してください。
